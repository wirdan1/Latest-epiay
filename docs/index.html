<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta id="api-description" name="description" content="Rest Api by Hookrest-Team">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link id="api-icon" rel="icon" href="/image/icon.png" type="image/png">
  <title id="api-title">Hookrest</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --color-primary: #2563eb;
      --color-primary-light: #3b82f6;
      --color-primary-dark: #1d4ed8;
      --color-success: #10b981;
      --color-success-light: #34d399;
      --color-success-dark: #059669;
      --color-background: #f8fafc;
      --color-card: #ffffff;
      --color-text: #1e293b;
      --color-text-light: #64748b;
      --color-border: #e2e8f0;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      color: var(--color-text);
      background-color: var(--color-background);
      line-height: 1.6;
    }

    /* Modern Header */
    nav {
      background-color: var(--color-card);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      padding: 16px 24px;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 50;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .nav-brand {
      display: flex;
      align-items: center;
      font-weight: 700;
      font-size: 1.25rem;
      color: var(--color-primary);
    }

    .nav-actions {
      display: flex;
      gap: 12px;
    }

    .nav-button {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 8px;
      background-color: var(--color-background);
      color: var(--color-text);
      transition: all 0.2s ease;
    }

    .nav-button:hover {
      background-color: var(--color-primary);
      color: white;
      transform: translateY(-2px);
    }

    /* Main Content */
    .main-container {
      padding-top: 80px;
      padding-bottom: 40px;
      max-width: 1200px;
      margin: 0 auto;
      width: 100%;
    }

    .content-wrapper {
      padding: 0 24px;
    }

    /* Modern Card */
    .card {
      background-color: var(--color-card);
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
      padding: 24px;
      margin-bottom: 24px;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
    }

    /* Banner */
    #banner {
      position: relative;
      overflow: hidden;
      border-radius: 16px;
      margin-bottom: 32px;
      background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
      color: white;
      padding: 32px;
    }

    .banner-content {
      position: relative;
      z-index: 2;
    }

    #banner::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
      opacity: 0.3;
    }

    #api-name {
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: 8px;
    }

    #api-author {
      background-color: rgba(255, 255, 255, 0.2);
      backdrop-filter: blur(10px);
      color: white;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 0.875rem;
      display: inline-block;
      margin-bottom: 16px;
    }

    #api-desc {
      font-size: 1rem;
      opacity: 0.9;
      margin-bottom: 20px;
      max-width: 80%;
    }

    #api-links {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-bottom: 20px;
    }

    .api-link-item {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .link-bullet {
      width: 8px;
      height: 8px;
      background-color: white;
      border-radius: 50%;
      opacity: 0.7;
    }

    .api-link {
      color: white;
      text-decoration: none;
      font-size: 0.875rem;
      opacity: 0.9;
      transition: opacity 0.2s;
    }

    .api-link:hover {
      opacity: 1;
      text-decoration: underline;
    }

    #api-copyright {
      font-size: 0.75rem;
      opacity: 0.7;
    }

    /* Search */
    .search-container {
      position: relative;
      margin-bottom: 24px;
    }

    #api-search {
      width: 100%;
      padding: 14px 16px 14px 48px;
      border-radius: 12px;
      border: 1px solid var(--color-border);
      font-size: 1rem;
      background-color: var(--color-card);
      transition: all 0.2s ease;
    }

    #api-search:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .search-icon {
      position: absolute;
      left: 16px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--color-text-light);
    }

    /* Category Navigation */
    .category-nav {
      display: flex;
      gap: 8px;
      margin-bottom: 24px;
      overflow-x: auto;
      padding-bottom: 8px;
      scrollbar-width: thin;
    }

    .category-nav::-webkit-scrollbar {
      height: 4px;
    }

    .category-nav::-webkit-scrollbar-thumb {
      background-color: var(--color-border);
      border-radius: 2px;
    }

    .category-tag {
      padding: 8px 16px;
      background-color: var(--color-card);
      border: 1px solid var(--color-border);
      border-radius: 20px;
      font-size: 0.875rem;
      font-weight: 500;
      white-space: nowrap;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .category-tag:hover {
      border-color: var(--color-primary);
      color: var(--color-primary);
    }

    .category-tag.active {
      background-color: var(--color-primary);
      color: white;
      border-color: var(--color-primary);
    }

    /* API Content */
    .api-category {
      margin-bottom: 32px;
    }

    .api-category-title {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 1px solid var(--color-border);
    }

    .api-category-title h3 {
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--color-text);
    }

    .api-category-count {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 28px;
      background-color: var(--color-primary);
      color: white;
      border-radius: 50%;
      font-size: 0.75rem;
      font-weight: 600;
      margin-left: 12px;
    }

    .api-endpoints {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }

    .api-endpoint {
      background-color: var(--color-card);
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.04);
      transition: all 0.2s ease;
      border: 1px solid var(--color-border);
      cursor: pointer;
    }

    .api-endpoint:hover {
      transform: translateY(-4px);
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      border-color: var(--color-primary-light);
    }

    .endpoint-header {
      display: flex;
      align-items: center;
      margin-bottom: 12px;
    }

    .endpoint-method {
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      margin-right: 10px;
    }

    .endpoint-method.get {
      background-color: rgba(16, 185, 129, 0.15);
      color: var(--color-success-dark);
    }

    .endpoint-method.post {
      background-color: rgba(37, 99, 235, 0.15);
      color: var(--color-primary-dark);
    }

    .endpoint-path {
      font-family: monospace;
      font-size: 0.9rem;
      color: var(--color-text);
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .endpoint-desc {
      font-size: 0.875rem;
      color: var(--color-text-light);
      margin-bottom: 16px;
      line-height: 1.5;
    }

    .endpoint-action {
      padding: 8px 16px;
      background-color: var(--color-primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      display: block;
      width: 100%;
      text-align: center;
    }

    .endpoint-action:hover {
      background-color: var(--color-primary-dark);
      transform: translateY(-2px);
    }

    /* Modal */
    #api-modal {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 100;
      padding: 20px;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
    }

    #api-modal.active {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background-color: var(--color-card);
      border-radius: 16px;
      width: 100%;
      max-width: 600px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
      padding: 24px;
      position: relative;
      transform: translateY(20px);
      transition: transform 0.3s ease;
    }

    #api-modal.active .modal-content {
      transform: translateY(0);
    }

    .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--color-border);
    }

    .modal-title-container {
      display: flex;
      align-items: center;
    }

    #api-method {
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      margin-right: 12px;
    }

    #api-method.get {
      background-color: rgba(16, 185, 129, 0.15);
      color: var(--color-success-dark);
    }

    #api-method.post {
      background-color: rgba(37, 99, 235, 0.15);
      color: var(--color-primary-dark);
    }

    #modal-title {
      font-size: 1.25rem;
      font-weight: 600;
    }

    #close-modal {
      background: none;
      border: none;
      cursor: pointer;
      color: var(--color-text-light);
      display: flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      transition: all 0.2s ease;
    }

    #close-modal:hover {
      background-color: var(--color-background);
      color: var(--color-text);
    }

    #api-description {
      font-size: 0.875rem;
      color: var(--color-text-light);
      margin-bottom: 20px;
      line-height: 1.5;
    }

    .params-container {
      margin-bottom: 24px;
    }

    .param-field {
      margin-bottom: 16px;
    }

    .param-field label {
      display: block;
      font-size: 0.875rem;
      font-weight: 500;
      margin-bottom: 6px;
      color: var(--color-text);
    }

    .param-field input {
      width: 100%;
      padding: 12px 16px;
      border-radius: 8px;
      border: 1px solid var(--color-border);
      font-size: 0.875rem;
      transition: all 0.2s ease;
    }

    .param-field input:focus {
      outline: none;
      border-color: var(--color-primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }

    .error-message {
      font-size: 0.75rem;
      color: #ef4444;
      margin-top: 4px;
      display: none;
    }

    #submit-api {
      padding: 12px 24px;
      background-color: var(--color-primary);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 0.875rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s ease;
      width: 100%;
    }

    #submit-api:hover {
      background-color: var(--color-primary-dark);
    }

    .response-container {
      margin-top: 24px;
      display: none;
    }

    .response-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 12px;
    }

    .response-header h4 {
      font-size: 1rem;
      font-weight: 600;
    }

    .response-status {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    #response-status {
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 700;
    }

    #response-status.success {
      background-color: rgba(16, 185, 129, 0.15);
      color: var(--color-success-dark);
    }

    #response-status.error {
      background-color: rgba(239, 68, 68, 0.15);
      color: #dc2626;
    }

    #response-time {
      font-size: 0.75rem;
      color: var(--color-text-light);
    }

    #response-data {
      background-color: var(--color-background);
      border-radius: 8px;
      padding: 16px;
      font-family: monospace;
      font-size: 0.875rem;
      overflow: auto;
      max-height: 300px;
      border: 1px solid var(--color-border);
    }

    /* Loader */
    .page-loader {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: var(--color-background);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      transition: opacity 0.3s ease;
    }

    .loader {
      width: 48px;
      height: 48px;
      border: 5px solid var(--color-primary-light);
      border-bottom-color: transparent;
      border-radius: 50%;
      animation: rotation 1s linear infinite;
    }

    @keyframes rotation {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .main-container {
        padding-top: 70px;
      }

      .content-wrapper {
        padding: 0 16px;
      }

      #banner {
        padding: 24px;
      }

      #api-name {
        font-size: 1.5rem;
      }

      #api-desc {
        max-width: 100%;
      }

      .api-endpoints {
        grid-template-columns: 1fr;
      }

      .modal-content {
        padding: 20px;
      }
    }

    @media (max-width: 480px) {
      nav {
        padding: 12px 16px;
      }

      .nav-brand {
        font-size: 1.125rem;
      }

      #banner {
        padding: 20px;
      }

      .category-nav {
        gap: 6px;
      }

      .category-tag {
        padding: 6px 12px;
        font-size: 0.75rem;
      }
    }
  </style>
</head>

<body>
  <div id="page-loader" class="page-loader">
    <div class="loader"></div>
  </div>

  <nav>
    <div class="nav-brand">
      <span id="api-title">Hookrest</span>
    </div>
    <div class="nav-actions">
      <a id="api-info" target="_blank" class="nav-button" title="Info">
        <span class="material-icons">info</span>
      </a>
      <a href="/docs/obfus.html" target="_blank" class="nav-button" title="JavaScript Obfuscator">
        <span class="material-icons">code</span>
      </a>
      <a href="https://danz-lovat.vercel.app/" target="_blank" class="nav-button" title="Download YouTube Video/Audio">
        <span class="material-icons">download</span>
      </a>
    </div>
  </nav>

  <div class="main-container">
    <div class="content-wrapper">
      <div id="banner" class="card">
        <div class="banner-content">
          <div class="flex items-center gap-2 mb-1">
            <a href="https://github.com/shinzxyz" target="_blank" class="flex items-center text-white opacity-80 hover:opacity-100 transition-opacity" style="font-size: 12px;">
              <i class="fab fa-github mr-2"></i>
              <span class="font-medium">Github</span>
            </a>
          </div>
          <div class="flex flex-wrap items-center gap-2 mb-3">
            <h2 id="api-name" class="text-3xl font-semibold">Name</h2>
            <div id="api-author" class="text-white text-xs font-semibold px-2 py-1 shrink-0">by Who.</div>
          </div>
          <p id="api-desc" class="text-xs mb-4">Desc</p>
          <div id="api-links" class="flex flex-col gap-1 text-xs"></div>
          <div class="mt-4 pt-3 border-t border-white border-opacity-20 flex justify-between items-center">
            <span id="api-copyright" class="text-xs">© 2025 Name. All rights reserved.</span>
          </div>
        </div>
      </div>

      <div class="search-container">
        <span class="material-icons search-icon">search</span>
        <input type="text" id="api-search" placeholder="Search API...">
      </div>

      <div class="category-nav-container">
        <div class="category-nav"></div>
      </div>

      <div id="api-content" class="tab-content"></div>
    </div>
  </div>

  <div id="api-modal">
    <div class="modal-content">
      <div class="modal-header">
        <div class="modal-title-container">
          <span id="api-method" class="get">GET</span>
          <h3 id="modal-title">API Request</h3>
        </div>
        <button id="close-modal">
          <span class="material-icons">close</span>
        </button>
      </div>
      <p id="api-description" class="text-xs font-medium text-gray-600 mt-1">API description will appear here</p>
      <div id="params-container" class="params-container"></div>
      <button id="submit-api">Send Request</button>
      <div id="response-container" class="response-container">
        <div class="response-header">
          <h4>Response</h4>
          <div class="response-status">
            <span id="response-status" class="success">200</span>
            <span id="response-time">200ms</span>
          </div>
        </div>
        <pre id="response-data" class="bg-gray-50 p-3 text-xs overflow-auto max-h-60"></pre>
      </div>
    </div>
  </div>

  <script>
    // JavaScript code remains mostly the same with minor adjustments for the new UI
    document.addEventListener("DOMContentLoaded", async function() {
      document.body.classList.add("noscroll");
      hideLoader();
      try {
        const endpoints = await (await fetch("/endpoints")).json();
        const set = await (await fetch("/set")).json();
        setContent("api-icon", "href", set.icon);
        setContent("api-title", "textContent", set.name.main);
        setContent("api-description", "content", set.description);
        setContent("api-name", "textContent", set.name.main);
        setContent("api-author", "textContent", `by ${set.author}`);
        setContent("api-desc", "textContent", set.description);
        setContent("api-copyright", "textContent", `© 2025 ${set.name.copyright}. All rights reserved.`);
        setContent("api-info", "href", set.info_url);
        setupApiLinks(set);
        setupApiContent(endpoints);
        setupApiButtonHandlers(endpoints);
        setupSearchFunctionality();
      } catch (error) {
        console.error("Error loading configuration:", error);
      }

      function setContent(id, property, value) {
        const element = document.getElementById(id);
        if (element) element[property] = value;
      }

      function setupApiLinks(gtw) {
        const apiLinksContainer = document.getElementById("api-links");
        apiLinksContainer.innerHTML = "";
        if (apiLinksContainer && gtw.links?.length) {
          gtw.links.forEach(link => {
            const linkContainer = document.createElement("div");
            linkContainer.className = "api-link-item";
            const bulletPoint = document.createElement("div");
            bulletPoint.className = `link-bullet`;
            const linkElement = document.createElement("a");
            linkElement.href = link.url;
            linkElement.textContent = link.name;
            linkElement.className = "api-link";
            linkElement.target = "_blank";
            linkContainer.appendChild(bulletPoint);
            linkContainer.appendChild(linkElement);
            apiLinksContainer.appendChild(linkContainer);
          });
        }
      }

      const pageLoader = document.getElementById("page-loader");
      window.addEventListener("load", function() {
        setTimeout(function() {
          const scrollPosition = parseInt(document.body.style.top || "0") * -1;
          document.body.classList.remove("noscroll");
          document.body.style.top = "";
          window.scrollTo(0, scrollPosition);
          pageLoader.style.opacity = "0";
          setTimeout(function() {
            pageLoader.style.display = "none";
          }, 800);
        }, 1e3);
      });

      function showLoader() {
        const scrollPosition = window.scrollY;
        document.body.style.top = `-${scrollPosition}px`;
        document.body.classList.add("noscroll");
        pageLoader.style.display = "flex";
        pageLoader.style.opacity = "1";
      }

      function hideLoader() {
        setTimeout(function() {
          const scrollPosition = parseInt(document.body.style.top || "0") * -1;
          document.body.classList.remove("noscroll");
          document.body.style.top = "";
          window.scrollTo(0, scrollPosition);
          pageLoader.style.opacity = "0";
          setTimeout(function() {
            pageLoader.style.display = "none";
          }, 800);
        }, 1e3);
      }

      function setupApiContent(gtw) {
        const apiContent = document.getElementById("api-content");
        apiContent.innerHTML = "";
        const categoryNavContainer = document.querySelector(".category-nav");
        categoryNavContainer.innerHTML = "";
        
        const allCategory = document.createElement("span");
        allCategory.className = "category-tag active";
        allCategory.textContent = "ALL";
        allCategory.dataset.category = "all";
        categoryNavContainer.appendChild(allCategory);
        
        const categories = [...new Set(gtw.endpoints.map(cat => cat.name))];
        categories.forEach(category => {
          const categoryTag = document.createElement("span");
          categoryTag.className = "category-tag";
          categoryTag.textContent = category.toUpperCase();
          categoryTag.dataset.category = category.toLowerCase();
          categoryNavContainer.appendChild(categoryTag);
        });
        
        const endpointsContainer = document.createElement("div");
        endpointsContainer.id = "endpoints-container";
        apiContent.appendChild(endpointsContainer);
        
        renderEndpoints(gtw.endpoints, "all");
        
        categoryNavContainer.addEventListener("click", function(e) {
          if (e.target.classList.contains("category-tag")) {
            document.querySelectorAll(".category-tag").forEach(tag => {
              tag.classList.remove("active");
            });
            e.target.classList.add("active");
            const category = e.target.dataset.category;
            renderEndpoints(gtw.endpoints, category);
            e.target.scrollIntoView({
              behavior: "smooth",
              block: "nearest",
              inline: "center"
            });
          }
        });
      }

      function renderEndpoints(endpoints, selectedCategory) {
        const endpointsContainer = document.getElementById("endpoints-container");
        endpointsContainer.innerHTML = "";
        
        endpoints.forEach(category => {
          if (selectedCategory !== "all" && category.name.toLowerCase() !== selectedCategory) {
            return;
          }
          
          const categoryContainer = document.createElement("div");
          categoryContainer.className = "api-category";
          
          const categoryHeader = document.createElement("div");
          categoryHeader.className = "api-category-title";
          
          const categoryName = document.createElement("h3");
          categoryName.className = "text-xl font-semibold text-gray-800";
          categoryName.textContent = category.name;
          
          const endpointCount = document.createElement("span");
          endpointCount.className = "api-category-count";
          endpointCount.textContent = Object.keys(category.items).length;
          
          categoryHeader.appendChild(categoryName);
          categoryHeader.appendChild(endpointCount);
          categoryContainer.appendChild(categoryHeader);
          
          const endpointsGrid = document.createElement("div");
          endpointsGrid.className = "api-endpoints";
          categoryContainer.appendChild(endpointsGrid);
          
          const sortedItems = Object.entries(category.items).sort(([, a], [, b]) => (a.name || "").localeCompare(b.name || "")).map(([, item]) => item);
          
          sortedItems.forEach(itemData => {
            const itemName = Object.keys(itemData)[0];
            const item = itemData[itemName];
            const itemElement = createApiItemElement(itemName, item);
            endpointsGrid.appendChild(itemElement);
          });
          
          endpointsContainer.appendChild(categoryContainer);
        });
      }

      function createApiItemElement(itemName, item) {
        const itemDiv = document.createElement("div");
        itemDiv.className = "api-endpoint";
        itemDiv.dataset.name = itemName || "";
        itemDiv.dataset.desc = item.desc || "";
        
        const methodPathContainer = document.createElement("div");
        methodPathContainer.className = "endpoint-header";
        
        const method = document.createElement("span");
        method.className = `endpoint-method ${item.method?.toLowerCase() || "get"}`;
        method.textContent = item.method || "GET";
        
        const path = document.createElement("span");
        path.className = "endpoint-path";
        path.textContent = item.path;
        
        methodPathContainer.appendChild(method);
        methodPathContainer.appendChild(path);
        
        const description = document.createElement("p");
        description.className = "endpoint-desc";
        description.textContent = item.desc || "No description";
        
        const button = document.createElement("button");
        button.className = "endpoint-action";
        button.dataset.apiPath = item.path || "";
        button.dataset.apiName = itemName || "";
        button.dataset.apiDesc = item.desc || "";
        button.textContent = "TRY";
        
        itemDiv.appendChild(methodPathContainer);
        itemDiv.appendChild(description);
        itemDiv.appendChild(button);
        
        return itemDiv;
      }

      function openApiModal(name, endpoint, description, method) {
        const modal = document.getElementById("api-modal");
        const modalContent = modal.querySelector(".modal-content");
        const closeModalBtn = document.getElementById("close-modal");
        const submitApiBtn = document.getElementById("submit-api");
        const modalTitle = document.getElementById("modal-title");
        const apiMethod = document.getElementById("api-method");
        const apiDescription = document.getElementById("api-description");
        const paramsContainer = document.getElementById("params-container");
        const responseContainer = document.getElementById("response-container");
        const responseData = document.getElementById("response-data");
        const responseStatus = document.getElementById("response-status");
        const responseTime = document.getElementById("response-time");
        
        const existingUrlDisplay = document.querySelector(".urlDisplay");
        if (existingUrlDisplay) existingUrlDisplay.remove();
        
        responseContainer.style.display = "none";
        responseData.innerHTML = "";
        submitApiBtn.style.display = "block";
        paramsContainer.style.display = "block";
        paramsContainer.innerHTML = "";
        
        modalTitle.textContent = name;
        apiDescription.textContent = description;
        apiMethod.textContent = method || "GET";
        apiMethod.className = `endpoint-method ${(method || "get").toLowerCase()}`;
        
        const apiKeyField = document.createElement("div");
        apiKeyField.className = "param-field";
        apiKeyField.innerHTML = `
          <label>API Key</label>
          <input type="text" id="param-apikey" value="yoedzx" placeholder="Enter your API key">
          <div id="error-apikey" class="error-message">API key is required</div>
        `;
        paramsContainer.appendChild(apiKeyField);
        
        const url = new URL(endpoint, window.location.origin);
        const urlParams = url.search ? url.search.substring(1).split("&") : [];
        
        urlParams.forEach(param => {
          const [key] = param.split("=");
          if (key && key !== "apikey") {
            const isOptional = key.startsWith("_");
            const paramField = document.createElement("div");
            paramField.className = "param-field";
            paramField.innerHTML = `
              <label>${key.capitalize()}</label>
              <input type="text" id="param-${key}" placeholder="Enter ${key}${isOptional ? " (optional)" : ""}">
              <div id="error-${key}" class="error-message">This field is required</div>
            `;
            paramsContainer.appendChild(paramField);
          }
        });
        
        submitApiBtn.onclick = async function() {
          let isValid = true;
          const apiKeyInput = document.getElementById("param-apikey");
          const apiKeyError = document.getElementById("error-apikey");
          
          if (!apiKeyInput.value.trim()) {
            isValid = false;
            apiKeyError.style.display = "block";
            apiKeyInput.style.borderColor = "#ef4444";
          } else {
            apiKeyError.style.display = "none";
            apiKeyInput.style.borderColor = "";
          }
          
          if (!isValid) return;
          
          responseContainer.style.display = "block";
          paramsContainer.style.display = "none";
          submitApiBtn.style.display = "none";
          
          const startTime = Date.now();
          
          try {
            let apiUrl = endpoint;
            const separator = apiUrl.includes("?") ? "&" : "?";
            apiUrl = `${apiUrl}${separator}apikey=${encodeURIComponent(apiKeyInput.value.trim())}`;
            
            const paramInputs = paramsContainer.querySelectorAll("input");
            paramInputs.forEach(input => {
              const key = input.id.replace("param-", "");
              const value = input.value.trim();
              if (key !== "apikey" && value !== "") {
                apiUrl += `&${encodeURIComponent(key)}=${encodeURIComponent(value)}`;
              }
            });
            
            const requestOptions = {
              method: "GET",
              headers: {
                "Content-Type": "application/json"
              }
            };
            
            const response = await fetch(apiUrl, requestOptions);
            const endTime = Date.now();
            const duration = endTime - startTime;
            
            responseStatus.textContent = response.status;
            responseStatus.className = response.ok ? "success" : "error";
            responseTime.textContent = `${duration}ms`;
            
            if (!response.ok) {
              const errorData = await response.json();
              throw new Error(errorData.message || "API request failed");
            }
            
            const contentType = response.headers.get("content-type");
            if (contentType.includes("application/json")) {
              const jsonData = await response.json();
              responseData.innerHTML = `<pre class="whitespace-pre-wrap break-words">${JSON.stringify(jsonData, null, 2)}</pre>`;
            } else {
              const text = await response.text();
              responseData.innerHTML = `<pre class="whitespace-pre-wrap break-words">${text}</pre>`;
            }
          } catch (error) {
            const endTime = Date.now();
            const duration = endTime - startTime;
            
            responseStatus.textContent = "Error";
            responseStatus.className = "error";
            responseTime.textContent = `${duration}ms`;
            
            responseData.innerHTML = `
              <div class="p-4 bg-red-50 border-l-4 border-red-500 rounded">
                <div class="flex items-center">
                  <div class="flex-shrink-0">
                    <svg class="h-5 w-5 text-red-500" viewBox="0 0 20 20" fill="currentColor">
                      <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd" />
                    </svg>
                  </div>
                  <div class="ml-3">
                    <p class="text-sm text-red-700">
                      ${error.message || "Invalid API key - please use ?apikey=yoedzx"}
                    </p>
                  </div>
                </div>
              </div>
            `;
          }
        };
        
        // Show modal
        modal.classList.add("active");
        document.body.classList.add("noscroll");
        
        const closeModal = function() {
          modal.classList.remove("active");
          document.body.classList.remove("noscroll");
        };
        
        closeModalBtn.onclick = closeModal;
        modal.addEventListener("click", function(event) {
          if (event.target === modal) {
            closeModal();
          }
        });
        
        document.addEventListener("keydown", function(event) {
          if (event.key === "Escape") {
            closeModal();
          }
        }, { once: true });
      }

      function setupApiButtonHandlers(gtw) {
        document.addEventListener("click", event => {
          if (event.target.classList.contains("endpoint-action")) {
            const { apiPath, apiName, apiDesc } = event.target.dataset;
            const currentItem = gtw.endpoints.flatMap(category => Object.values(category.items)).map(itemData => {
              const itemName = Object.keys(itemData)[0];
              return {
                name: itemName,
                ...itemData[itemName]
              };
            }).find(item => item.path === apiPath && item.name === apiName);
            
            openApiModal(apiName, apiPath, apiDesc, currentItem?.method);
          }
        });
      }

      function setupSearchFunctionality() {
        const searchInput = document.getElementById("api-search");
        if (!searchInput) return;
        
        let originalEndpoints = null;
        let currentCategory = "all";
        
        document.querySelector(".category-nav").addEventListener("click", function(e) {
          if (e.target.classList.contains("category-tag")) {
            currentCategory = e.target.dataset.category;
            if (searchInput.value.trim()) {
              searchInput.dispatchEvent(new Event("input"));
            }
          }
        });

        function captureOriginalData() {
          const categories = document.querySelectorAll(".api-category");
          const result = [];
          
          categories.forEach(category => {
            const categoryName = category.querySelector(".api-category-title h3").textContent.toLowerCase();
            const endpointsGrid = category.querySelector(".api-endpoints");
            const items = Array.from(endpointsGrid.querySelectorAll(".api-endpoint")).map(item => {
              return {
                element: item.cloneNode(true),
                name: item.dataset.name,
                desc: item.dataset.desc,
                category: categoryName
              };
            });
            
            result.push({
              categoryElement: category,
              categoryName: categoryName,
              endpointsGrid: endpointsGrid,
              items: items
            });
          });
          
          return result;
        }

        function restoreOriginalData() {
          if (!originalEndpoints) return;
          
          originalEndpoints.forEach(categoryData => {
            categoryData.categoryElement.style.display = "none";
            
            if (currentCategory === "all" || categoryData.categoryName === currentCategory) {
              categoryData.categoryElement.style.display = "block";
              categoryData.endpointsGrid.innerHTML = "";
              
              categoryData.items.forEach(item => {
                categoryData.endpointsGrid.appendChild(item.element.cloneNode(true));
              });
            }
          });
        }
        
        originalEndpoints = captureOriginalData();
        
        searchInput.addEventListener("input", function(e) {
          const searchTerm = e.target.value.toLowerCase().trim();
          
          if (!searchTerm) {
            restoreOriginalData();
            return;
          }
          
          originalEndpoints.forEach(categoryData => {
            const shouldShowCategory = currentCategory === "all" || categoryData.categoryName === currentCategory;
            const visibleItems = categoryData.items.filter(item => {
              if (!shouldShowCategory) return false;
              
              const title = item.name?.toLowerCase() || "";
              const desc = item.desc?.toLowerCase() || "";
              
              return title.includes(searchTerm) || desc.includes(searchTerm);
            });
            
            categoryData.endpointsGrid.innerHTML = "";
            
            if (visibleItems.length === 0) {
              categoryData.categoryElement.style.display = "none";
            } else {
              categoryData.categoryElement.style.display = "block";
              
              visibleItems.forEach(item => {
                categoryData.endpointsGrid.appendChild(item.element.cloneNode(true));
              });
            }
          });
        });
      }

      // Helper function for string capitalization
      String.prototype.capitalize = function() {
        return this.charAt(0).toUpperCase() + this.slice(1);
      };
    });
  </script>
</body>

</html>
